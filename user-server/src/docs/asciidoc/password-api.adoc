[[password-reset-flow]]
== 비밀번호 재설정 플로우

비밀번호 재설정은 다음 3단계로 진행됩니다:

1. **인증코드 전송**: 이메일로 6자리 인증코드를 전송받습니다.
2. **인증코드 검증**: 받은 인증코드가 유효한지 확인합니다.
3. **비밀번호 재설정**: 새로운 비밀번호로 변경합니다.

[source]
----
사용자 -> 서버: POST /api/v1/password/code (이메일 전송)
서버 -> 이메일: 인증코드 발송
사용자 -> 서버: POST /api/v1/password/verify (코드 검증)
사용자 -> 서버: POST /api/v1/password/reset (비밀번호 재설정)
----

[[password-api]]
== 비밀번호 재설정 API

[[password-send-code]]
=== 인증코드 전송

이메일로 비밀번호 재설정 인증코드를 전송합니다.

==== HTTP 요청
include::{snippets}/password/send-code/http-request.adoc[]

==== HTTP 응답
include::{snippets}/password/send-code/http-response.adoc[]

==== 응답 필드
include::{snippets}/password/send-code/response-fields.adoc[]

==== 제약사항
* 인증코드는 2분간 유효합니다.
* 인증코드 재전송은 1분 쿨다운이 적용됩니다.
* 등록되지 않은 이메일인 경우 404 에러가 반환됩니다.
* 탈퇴하거나 정지된 회원은 코드를 받을 수 없습니다.

[[password-verify-code]]
=== 인증코드 검증

전송받은 인증코드가 올바른지 검증합니다.

==== HTTP 요청
include::{snippets}/password/verify-code/http-request.adoc[]

==== 요청 필드
include::{snippets}/password/verify-code/request-fields.adoc[]

==== HTTP 응답
include::{snippets}/password/verify-code/http-response.adoc[]

==== 응답 필드
include::{snippets}/password/verify-code/response-fields.adoc[]

==== 제약사항
* 코드는 반드시 6자리 숫자여야 합니다.
* 인증코드가 만료된 경우 400 에러가 반환됩니다.
* 잘못된 코드인 경우 400 에러가 반환됩니다.

[[password-reset]]
=== 비밀번호 재설정

검증된 인증코드로 새로운 비밀번호를 설정합니다.

==== HTTP 요청
include::{snippets}/password/reset-password/http-request.adoc[]

==== 요청 필드
include::{snippets}/password/reset-password/request-fields.adoc[]

==== HTTP 응답
include::{snippets}/password/reset-password/http-response.adoc[]

==== 응답 필드
include::{snippets}/password/reset-password/response-fields.adoc[]

==== 비밀번호 규칙
* 최소 8자 이상
* 영문, 숫자, 특수문자(@$!%*#?&) 각각 1개 이상 포함
* 기존 비밀번호와 동일한 비밀번호는 사용할 수 없습니다.

==== 제약사항
* 인증코드는 재설정 성공 후 즉시 삭제됩니다.
* 동일한 코드로 여러 번 비밀번호를 재설정할 수 없습니다.

[[password-error-codes]]
== 에러 코드

비밀번호 재설정 관련 에러 코드입니다.

|===
| 에러 코드 | HTTP 상태 | 설명

| `PASSWORD001`
| 429 Too Many Requests
| 인증코드 재전송은 1분 후에 가능합니다

| `PASSWORD002`
| 400 Bad Request
| 기존 비밀번호와 동일한 비밀번호는 사용할 수 없습니다

| `PASSWORD003`
| 400 Bad Request
| 인증코드가 일치하지 않습니다

| `PASSWORD004`
| 400 Bad Request
| 인증코드가 만료되었습니다

| `USER001`
| 404 Not Found
| 사용자를 찾을 수 없습니다

| `USER002`
| 403 Forbidden
| 탈퇴한 사용자입니다

| `USER003`
| 403 Forbidden
| 정지된 사용자입니다
|===
